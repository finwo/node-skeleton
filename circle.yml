general:
  branches:
    only:
      - v2
machine:
  environment:
    GCLOUD_PROJECT: trackthis-169509

dependencies:
  pre:
    # Authenticate with gcloud
    - echo $GCLOUD_SERVICE_KEY | base64 -di > ${HOME}/client-secret.json
    - gcloud --quiet components update app
    - gcloud auth activate-service-account --key-file ${HOME}/client-secret.json
    - gcloud config set project $GCLOUD_PROJECT
  cache_directories:
    - "node_modules"
    - "bower_components"
  override:
    - npm install
